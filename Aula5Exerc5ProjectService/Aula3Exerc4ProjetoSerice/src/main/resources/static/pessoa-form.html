<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <title>Pessoa - Raphael Perim do Carmo - RA 12426977</title>
    <style>
        body { font-family: Arial; margin: 25px; background-color: #f8f8f8; }
        label { display: block; margin-top: 8px; }
        input {
          width: 100%; padding: 6px; margin-top: 4px;
          border: 1px solid #ccc; border-radius: 4px;
        }
        button {
          margin-top: 10px; padding: 8px 15px;
          border: none; border-radius: 5px; cursor: pointer;
        }
        .btn-ok { background-color: #4CAF50; color: white; }
        .btn-del { background-color: #e53935; color: white; }
        .btn-clear { background-color: #555; color: white; }
        #saida { background:#eee;padding:10px;border-radius:5px;margin-top:15px;white-space:pre-wrap; }
    </style>
</head>
<body>
<h2>Cadastro de Pessoa</h2>
<p>Raphael Perim do Carmo - RA 12426977</p>

<form id="formPessoa">
    <label>ID (para alterar ou excluir)</label>
    <input id="id" type="number" placeholder="ex: 1">

    <label>Nome</label>
    <input id="nome" type="text" required>

    <label>Endereço</label>
    <input id="endereco">

    <label>Telefone</label>
    <input id="telefone">
</form>

<button class="btn-ok" onclick="salvar()">Salvar</button>
<button class="btn-del" onclick="excluir()">Excluir</button>
<button class="btn-clear" onclick="limpar()">Novo</button>

<div id="saida">Nenhuma ação ainda.</div>

<script>
    const api = "http://localhost:8080";

    async function salvar() {
      const pessoa = {
        nome: nome.value,
        endereco: endereco.value,
        telefone: telefone.value
      };
      const id = document.getElementById("id").value;
      const url = id ? `${api}/pessoa/${id}` : `${api}/pessoa`;
      const metodo = id ? "PUT" : "POST";

      try {
        const res = await fetch(url, {
          method: metodo,
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify(pessoa)
        });
        const txt = await res.text();
        saida.textContent = txt;
      } catch (e) {
        saida.textContent = "Erro ao salvar: " + e.message;
      }
    }

    async function excluir() {
      const id = document.getElementById("id").value;
      if (!id) return alert("Informe o ID da pessoa que deseja excluir.");
      if (!confirm("Tem certeza que quer excluir?")) return;
      try {
        const res = await fetch(`${api}/pessoa/${id}`, { method: "DELETE" });
        const txt = await res.text();
        saida.textContent = txt;
      } catch (e) {
        saida.textContent = "Erro ao excluir: " + e.message;
      }
    }

    function limpar() {
      document.getElementById("formPessoa").reset();
      saida.textContent = "Campos limpos.";
    }
</script>
</body>
</html>
