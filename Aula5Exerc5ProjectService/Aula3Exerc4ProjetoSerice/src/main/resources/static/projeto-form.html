<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <title>Projeto - Raphael Perim do Carmo - RA 12426977</title>
    <style>
        body { font-family: Arial; margin: 25px; background-color: #f8f8f8; }
        label { display: block; margin-top: 8px; }
        input, select {
          width: 100%; padding: 6px; margin-top: 4px;
          border: 1px solid #ccc; border-radius: 4px;
        }
        button {
          margin-top: 10px; padding: 8px 15px;
          border: none; border-radius: 5px; cursor: pointer;
        }
        .btn-ok { background-color: #4CAF50; color: white; }
        .btn-del { background-color: #e53935; color: white; }
        .btn-clear { background-color: #555; color: white; }
        #saida { background:#eee;padding:10px;border-radius:5px;margin-top:15px;white-space:pre-wrap; }
    </style>
</head>
<body>
<h2>Cadastro de Projeto</h2>
<p>Raphael Perim do Carmo - RA 12426977</p>

<form id="formProjeto">
    <label>ID (para alterar ou excluir)</label>
    <input id="id" type="number" placeholder="ex: 1">

    <label>Nome do Projeto</label>
    <input id="nome" type="text" required>

    <label>Estado</label>
    <select id="estado">
        <option value="planejado">Planejado</option>
        <option value="ativo">Ativo</option>
        <option value="terminado">Terminado</option>
        <option value="cancelado">Cancelado</option>
    </select>

    <label>Quantidade de Pessoas</label>
    <input id="qtdPessoas" type="number" min="0">

    <label>Gestor do Projeto</label>
    <input id="gestorProjeto">

    <label>Líder Técnico</label>
    <input id="liderTecnico">

    <label>Gerente Responsável</label>
    <input id="gerente">

    <label>Data de Início</label>
    <input id="dataInicio" type="date">

    <label>Data de Fim</label>
    <input id="dataFim" type="date">
</form>

<button class="btn-ok" onclick="salvar()">Salvar</button>
<button class="btn-del" onclick="excluir()">Excluir</button>
<button class="btn-clear" onclick="limpar()">Novo</button>

<div id="saida">Nenhuma ação ainda.</div>

<script>
    const api = "http://localhost:8080";

    async function salvar() {
      const projeto = {
        nome: nome.value,
        estado: estado.value,
        qtdPessoas: qtdPessoas.value,
        gestorProjeto: gestorProjeto.value,
        liderTecnico: liderTecnico.value,
        gerente: gerente.value,
        dataInicio: dataInicio.value,
        dataFim: dataFim.value
      };
      const id = document.getElementById("id").value;
      const url = id ? `${api}/projeto/${id}` : `${api}/projeto`;
      const metodo = id ? "PUT" : "POST";

      try {
        const res = await fetch(url, {
          method: metodo,
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify(projeto)
        });
        const txt = await res.text();
        saida.textContent = txt;
      } catch (e) {
        saida.textContent = "Erro ao salvar: " + e.message;
      }
    }

    async function excluir() {
      const id = document.getElementById("id").value;
      if (!id) return alert("Informe o ID do projeto que deseja excluir.");
      if (!confirm("Tem certeza que quer excluir?")) return;
      try {
        const res = await fetch(`${api}/projeto/${id}`, { method: "DELETE" });
        const txt = await res.text();
        saida.textContent = txt;
      } catch (e) {
        saida.textContent = "Erro ao excluir: " + e.message;
      }
    }

    function limpar() {
      document.getElementById("formProjeto").reset();
      saida.textContent = "Campos limpos.";
    }
</script>
</body>
</html>
